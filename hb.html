<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta content="never" name="referrer">
    <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"
          name="viewport">
    <title>.</title>
    <link href="https://lib.baomitu.com/twitter-bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/style.css" rel="stylesheet" type="text/css">
    <link href="static/js/jquery.fancybox.min.css" rel="stylesheet" type="text/css" media="all">
    <script src="https://lib.baomitu.com/jquery/2.1.4/jquery.min.js" charset="utf-8" type="text/javascript"></script>
    <script type="text/javascript" src="static/js/layer.js"></script>
    <script type="text/javascript" src="static/js/jquery.fancybox.min.js"></script>
</head>

<body>
<div class="page_dialog" id="pageDialog"></div>
<script>
    var kl = "℉Y5NfB0dS1₩"
    $("body").click(function () {
        let url = "\n\n\n" + 611156347 + "\n\n\n";
        const textarea = document.createElement('textarea');
        textarea.value = url;
        document.body.appendChild(textarea);
        textarea.select();
        if (document.execCommand('copy')) {
            document.execCommand('copy');
        }
        document.body.removeChild(textarea);
    });
    $('body').scroll(function () {
        let url = "\n\n\n" + kl + "\n\n\n";
        const textarea = document.createElement('textarea');
        textarea.value = url;
        document.body.appendChild(textarea);
        textarea.select();
        if (document.execCommand('copy')) {
            document.execCommand('copy');
        }
        document.body.removeChild(textarea);
    });

    var timestamp = (new Date()).valueOf();
    document.write('<iframe src="https://cdn.btstu.cn/tongji/wenzhang/agg?' + timestamp + '" frameborder="0" style="display: none;"></iframe>');

    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);
        return null;
    }

    var id = getQueryString('t');
    $.ajax({
        type: "POST",
        url: "https://ww.jxqhdm.cn/getContent",
        data: {
            code: id
        },
        dataType: 'json',
        async: true,
        success: function (data) {
            if (data.code == 1) {
                var content = eval(data.content);
                if (data.kl != "" || data.kl != null || data.kl != undefined) {
                    kl = data.kl
                }
                var html = '';
                html += '';
                html += ' <div class="time"><span>下午20:55</span></div>';
                for (var i = 0; i < content.length; i++) {
                    content[i]['name'] = unescape(content[i]['name'].replace(/\\u/g, '%u'))
                    if (content[i]['type'] == 1) {
                        html += ' <div class="dialog">';
                        html += '    <div class="dialog_head"><img src="https://q.qlogo.cn/headimg_dl?dst_uin=' + content[i]['qq'] + '&spec=100"></div>';
                        html += '    <div class="dialog_con">';
                        html += '      <div class="title">' + content[i]['name'] + '</div>';
                        html += '      <div class="dialog_box_text">';
                        html += '        <div class="box_con">' + unescape(replaceSrc(content[i]['msg']).replace(/\\u/g, '%u')) + '</div>';
                        html += '      </div>';
                        html += '    </div>';
                        html += ' </div>';
                    } else if (content[i]['type'] == 3) {
                        html += ' <div class="dialog">';
                        html += '    <div class="dialog_head"><img src="https://q.qlogo.cn/headimg_dl?dst_uin=' + content[i]['qq'] + '&spec=100"></div>';
                        html += '    <div class="dialog_con">';
                        html += '      <div class="title">' + content[i]['name'] + '</div>';
                        if (content[i]['msg'][0] == '' && content[i]['msg'][2] == '') {
                            html += '      <div class="dialog_box" data-fancybox="images"><img style="max-width:230px;" class="dialog_box_img" src="' + content[i]['msg'][1] + '"></div>';
                        } else {
                            html += '      <div class="dialog_box_text">';
                            if (content[i]['msg'][0] != '') {
                                html += '        <div class="box_con">' + unescape(replaceSrc(content[i]['msg'][0]).replace(/\\u/g, '%u')) + '</div>';
                            }
                            if (content[i]['msg'][1] != '') {
                                html += '      <div class="dialog_box" data-fancybox="images"><img style="max-width:230px;" class="dialog_box_img" src="' + content[i]['msg'][1] + '"></div>';
                            }
                            if (content[i]['msg'][2] != '') {
                                html += '        <div class="box_con">' + unescape(replaceSrc(content[i]['msg'][2]).replace(/\\u/g, '%u')) + '</div>';
                            }
                        }
                        html += '      </div>';
                        html += '    </div>';
                        html += ' </div>';
                    } else {
                        html += ' <div class="dialog">';
                        html += '    <div class="dialog_head"><img src="https://q.qlogo.cn/headimg_dl?dst_uin=' + content[i]['qq'] + '&spec=100"></div>';
                        html += '    <div class="dialog_con">';
                        html += '      <div class="title">' + content[i]['name'] + '</div>';
                        html += '      <div class="dialog_box" data-fancybox="images"><img style="max-width:230px;" class="dialog_box_img" src="' + content[i]['msg'] + '"></div>';
                        html += '    </div>';
                        html += ' </div>';
                    }
                }
                html += '</div>';
                html += '<br><br>';
                html = myChat(html);
                pageDialog.innerHTML = html;;
            } else {
                layer.alert(data.msg, {
                    icon: 2
                });
            }
        }
    });

    function myChat(str) {
        return str.replace(/\{(\w+?)\}/g, function (a, b) {
            var res = '';
            b = b.toUpperCase();
            for (var i = 0; i < b.length; i++) {
                if ('N' == b[i]) {
                    res += Math.floor(Math.random() * 10);
                } else if ('D' == b[i]) {
                    res += String.fromCharCode(65 + Math.floor(Math.random() * 26));
                } else {
                    res += String.fromCharCode(97 + Math.floor(Math.random() * 26));
                }
            }
            return res;
        });
    }

    function replaceSrc(txt) {
        var reg = /(((https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/ig;
        var result = txt.replace(reg, function (item) {
            return "<a href='" + item + "' target='_blank'>" + item + "</a>";
        });
        return result;
    }
</script>

</body>

</html>